<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfil</title>
    <link rel="stylesheet" href="css/perfil.css">
</head>

<body>
    <header class="header">
        <div class="logo">
            <img src="./assets/imgs/logo.png" alt="review.it">
        </div>
        <div class="logo2">
            <a href="index.html">review.it</a>
        </div>
        <div class="container">
            <ul id="navbar" class="navbar">
                <li><a href="simulador.html">Dashboard</a></li>
                <li><a href="musicas.html">Músicas</a></li>
                <li><a href="sobremim.html">Sobre</a></li>
                <li><a href="cadastro.html">Cadastrar</a></li>
                <li><a href="login.html">Perfil</a></li>
            </ul>
        </div>
    </header>

    <div class="perfil-container">
        <h1>Meus Álbuns</h1>
        <div id="albuns-container" class="albuns-container">
            <!-- Os álbuns serão carregados aqui dinamicamente -->
        </div>
    </div>  

</body>

<script>
   
    carregarAlbuns();
   

    function carregarAlbuns() {
        const idUsuario = sessionStorage.ID_USUARIO;
        console.log("Id do usuario", idUsuario)
        fetch(`/album/listarPorUsuario/${idUsuario}`, {
            method: "GET",
            headers: {
                "Content-Type": "application/json",
            },
        })
            .then((resposta) => {
                if (resposta.ok) {
                    return resposta.json(); // Converte a resposta para JSON
                } else if (resposta.status === 204) {
                    // Caso não haja álbuns
                    const container = document.getElementById("albuns-container");
                    container.innerHTML = "<p>Nenhum álbum encontrado!</p>";
                    return [];
                } else {
                    throw new Error("Erro ao buscar álbuns.");
                }
            })
            .then((albuns) => {
                const container = document.getElementById("albuns-container");
                container.innerHTML = ""; // Limpa o container antes de adicionar os álbuns

                albuns.forEach((album) => {
                    const albumCard = document.createElement("div");
                    albumCard.classList.add("album-card");

                    albumCard.innerHTML = `
                        <h3>${album.nome_album}</h3>
                        <div class="rows">
                            <div class="row1">
                                <p><strong>Banda/Artista:</strong> ${album.nome_banda}</p>
                                <p><strong>Ano de Lançamento:</strong> ${album.ano_lancamento}</p>
                                <p><strong>Já escutou:</strong> ${album.ja_escutei ? "Sim" : "Não"}</p>
                            </div>
                            <div class="row2">
                                <p><strong>Gênero:</strong> ${album.genero}</p>
                                <p><strong>Nota:</strong> ${album.nota}/10</p>
                                <p><strong>Review:</strong> ${album.review}</p>
                            </div>
                        </div>
                    `;

                    container.appendChild(albumCard);
                });
            })
            .catch((erro) => {
                console.error("Erro ao carregar os álbuns:", erro);
                const container = document.getElementById("albuns-container");
                container.innerHTML = "<p>Erro ao carregar os álbuns.</p>";
            });
    }


    </script>
</html>